
```{r}
library(dplyr)
library(ISLR)
library(regclass)
```

Instructions for Questions 1 – 6
Georgia Tech Bank (GT Bank) just hired you as a consultant, to help them better understand their business. On your first day, you decide to use the “Credit” dataset from the ISLR package, as a proxy, to answer questions about their customer base. Use the “Credit” dataset from the ISLR package, drop the ID column, and model the data (linear-linear model) such that Balance is your dependent variable and the rest of the features (Income, Limit, Rating, Cards, Age, Education, Gender, Student, Married, and Ethnicity) are your independent variables. Use your model to answer questions Q1 through Q6.

 

Data Dictionary for the “Credit” Dataset:


1. Balance: This is the average credit card balance in dollars for each individual.
2. Income: The annual income of the individual in thousands of dollars.
3. Limit: The credit limit on the individual’s credit card.
4. Rating: The individual’s credit rating.
5. Cards: The number of credit cards owned by the individual.
6. Age: The age of the individual.
7. Education: The highest level of education completed by the individual.
8. Gender: The gender of the individual (e.g., “Male” or “Female”).
9. Student: Indicates whether the individual is a student (e.g., “Yes” or “No”).
10. Married: Indicates whether the individual is married (e.g., “Yes” or “No”).
11. Ethnicity: The ethnicity of the individual, which can include categories such as “African American,” “Asian,” and “Caucasian.”

Note: To access it, simply install the ISLR package in R (if you haven't already) and load the dataset using the following commands: install.packages("ISLR")
library(ISLR)
data(Credit)

Credit
## 1-3 Which features are significant at an alpha level of 0.001 ?

```{r}
summary(Credit)
head(Credit)

credituse <- Credit[-1]
cred_mod = lm (Balance ~., data = credituse)
summary(cred_mod)

```
## 4 Which features have a high level of multicollinearity, with a VIF over 5?


```{r}
VIF(cred_mod)
```
## 5 How many influential points are included in the dataset, with a Cook’s distance over 1?

```{r}
cd = cooks.distance(cred_mod)
cookcred = credituse
cookcred$cook = cd
print(cookcred[cd>1,])
```

## 6 Which statement correctly describes the residual vs fitted plot for the model?

```{r}
par(mfrow = c(2, 2))
plot(cred_mod)
```

## 7 Using the same Credit dataset in the ISLR package with Balance as your dependent variable and Income, Rating, and Age as your independent variable, create a linear-linear, log-linear, linear-log, and log-log model. Based on the R-Squared, which model has the best performance? Note: 1) Balance contains 0’s and a 1 needs to be added to the column before you can perform the log transformation (i.e. log(x + 1)). 2)  For both log-log and linear-log models, simply take the log of each independent variable, like log(X1), log(X2), and log (X3).


```{r}
## linear-linear
modelLinLin = lm(Balance~ Income + Rating + Age, data = credituse)
summary(modelLinLin)

## linear-log
modelLinLog = lm(Balance~ log(Income) + log(Rating) + log(Age), data = credituse)
summary(modelLinLog)

## log-linear
modelLogLin = lm(log(Balance + 1)~ Income + Rating + Age, data = credituse)
summary(modelLogLin)

## log-log
modelLogLog = lm(log(Balance+1)~ log(Income) + log(Rating) + log(Age), data = credituse)
summary(modelLogLog)
```

## 8 GT Bank wants you to predict the average credit card balance of Amy Henderson, a new customer to the bank. GT Bank knows that she is a student at Georgia Tech and makes 30,000 at her part time job. Use the Credit dataset from the ISLR package to create a model - that uses Balance as the dependent variable; and Income, Student, and the interaction between Income and Student as independent variables. Then use that model to predict the average credit card balance for Amy Henderson. Round your answer to the nearest dollar.

```{r}
credituse$incstu = credituse$Income * ( as.integer(credituse$Student)-1)
cred_mod_inter = lm(Balance ~ Income + Student + incstu, data=credituse)
summary(cred_mod_inter)
```

